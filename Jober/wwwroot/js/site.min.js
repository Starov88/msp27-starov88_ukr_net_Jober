"use strict";function beep(){}function loadAjaxPage(n){var t=$(n.currentTarget);(changeStateLoader("on"),t.hasClass("j-submenu-item"))||(n.preventDefault(),$("#j-content").load("/?category="+t.data("category_id")+" #j-flex-grid",null,function(){menuActiveLogic(t);changeStateLoader("off");$("a[data-category_id]").click(loadAjaxPage);$(".j-sub-category").click(function(){changeStateLoader("on")});var n=t.text()==""?"Главная":t.text();$("#j-content").prev().text(n)}))}function menuActiveLogic(n){var t=$(".j-side-menu-item");t.each(function(t,i){if($(i).data("category_id")===n.data("category_id")){$(i).hasClass("active")||$(i).addClass("active");var r=$(i).next();r.hasClass("j-submenu-hidden")&&r.removeClass("j-submenu-hidden");r.children().removeClass("active")}else $(i).hasClass("active")&&$(i).removeClass("active"),$(i).next().hasClass("j-submenu-hidden")||$(i).next().addClass("j-submenu-hidden")})}function changeStateLoader(n,t=null){t!==null&&t.html("");n==="on"||n===!0?$("#j-loader, #j-loader-shade").removeClass("hidden"):$("#j-loader, #j-loader-shade").addClass("hidden")}function touchRobot(){var n=$("#j-robot"),t="/images/animation/"+getRandomInt(1,4)+".gif";n.attr("src",t);timerId&&clearTimeout(timerId);timerId=setTimeout(function(){n.attr("src","/images/animation/0.gif")},1e4)}function logOut(){$.ajax({url:"/Account/Logout",method:"POST",success:function(){},error:function(){alert("Ошибка при выходе")}})}function getRandomInt(n,t){return Math.floor(Math.random()*(t-n))+n}var hubUrl=document.location.protocol+"//"+document.location.host+"/orderhub",httpConnection=new signalR.HttpConnection(hubUrl),hubConnection=new signalR.HubConnection(httpConnection),timerId;hubConnection.start();$(document).ready(function(){$("[data-category_id]").click(loadAjaxPage);$("#j-loginmenu > span > ul > li > a").click(function(){changeStateLoader("on")});$("#j-toggle-menu").click(function(){$("#j-side-menu").toggleClass("hidden-xs");$("#j-side-menu").toggleClass("hidden-sm")});$("#j-robot").click(touchRobot);setInterval(touchRobot,6e4);$("#j-logout").click(logOut);hubConnection.on("Send",function(n){var t,u,i,f,r;if(console.log("signal"),window.localStorage&&window.localStorage.WorkerSettingsJSON&&(t=JSON.parse(window.localStorage.WorkerSettingsJSON),t)){let e=JSON.parse(n);if(e.cityId==t.cityId)for(u=t.districtIds,i=0;i<u.length;i++)if(u[i]==e.districtId)for(f=t.categoryIds,r=0;r<f.length;r++)if(f[r]==e.categoryId){let n=$("#j-robot-dialog");n.text(e.message);n.removeClass("hidden");setTimeout(function(){n.addClass("hidden")},8e3);return}}})});